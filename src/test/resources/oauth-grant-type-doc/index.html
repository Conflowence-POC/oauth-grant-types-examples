<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=BnIqpcFAcReH0Tw3JLCcnA');ol.lst-kix_44an8rwzua74-6.start{counter-reset:lst-ctn-kix_44an8rwzua74-6 0}.lst-kix_44an8rwzua74-1>li{counter-increment:lst-ctn-kix_44an8rwzua74-1}ol.lst-kix_44an8rwzua74-3.start{counter-reset:lst-ctn-kix_44an8rwzua74-3 0}.lst-kix_ao7i0ho19mha-8>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-8}ol.lst-kix_44an8rwzua74-0.start{counter-reset:lst-ctn-kix_44an8rwzua74-0 0}.lst-kix_44an8rwzua74-0>li{counter-increment:lst-ctn-kix_44an8rwzua74-0}.lst-kix_ng8knyk2ieud-6>li:before{content:"\0025cf  "}.lst-kix_44an8rwzua74-2>li{counter-increment:lst-ctn-kix_44an8rwzua74-2}ol.lst-kix_ao7i0ho19mha-2.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-2 0}.lst-kix_ng8knyk2ieud-4>li:before{content:"\0025cb  "}.lst-kix_ng8knyk2ieud-5>li:before{content:"\0025a0  "}ol.lst-kix_ao7i0ho19mha-5.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-5 0}.lst-kix_ng8knyk2ieud-3>li:before{content:"\0025cf  "}.lst-kix_ao7i0ho19mha-7>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-7}.lst-kix_ng8knyk2ieud-0>li:before{content:"\0025cf  "}.lst-kix_ng8knyk2ieud-1>li:before{content:"\0025cb  "}.lst-kix_ng8knyk2ieud-2>li:before{content:"\0025a0  "}ol.lst-kix_ao7i0ho19mha-8.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-8 0}ol.lst-kix_ao7i0ho19mha-1.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-1 0}.lst-kix_44an8rwzua74-4>li{counter-increment:lst-ctn-kix_44an8rwzua74-4}.lst-kix_h2g10xayxpic-7>li:before{content:"\0025cb  "}.lst-kix_h2g10xayxpic-8>li:before{content:"\0025a0  "}.lst-kix_ao7i0ho19mha-5>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-5}.lst-kix_h2g10xayxpic-6>li:before{content:"\0025cf  "}.lst-kix_h2g10xayxpic-3>li:before{content:"\0025cf  "}.lst-kix_h2g10xayxpic-4>li:before{content:"\0025cb  "}.lst-kix_ao7i0ho19mha-1>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-1}.lst-kix_8fr0hoifq0ng-8>li:before{content:"\0025a0  "}.lst-kix_h2g10xayxpic-5>li:before{content:"\0025a0  "}.lst-kix_ng8knyk2ieud-7>li:before{content:"\0025cb  "}ol.lst-kix_44an8rwzua74-5.start{counter-reset:lst-ctn-kix_44an8rwzua74-5 0}.lst-kix_h2g10xayxpic-0>li:before{content:"\0025cf  "}.lst-kix_ng8knyk2ieud-8>li:before{content:"\0025a0  "}ul.lst-kix_h2g10xayxpic-8{list-style-type:none}ul.lst-kix_h2g10xayxpic-7{list-style-type:none}.lst-kix_ao7i0ho19mha-7>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-7,lower-latin) ". "}.lst-kix_h2g10xayxpic-2>li:before{content:"\0025a0  "}ul.lst-kix_h2g10xayxpic-6{list-style-type:none}ul.lst-kix_h2g10xayxpic-5{list-style-type:none}ol.lst-kix_ao7i0ho19mha-0.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-0 0}ul.lst-kix_h2g10xayxpic-4{list-style-type:none}ol.lst-kix_ao7i0ho19mha-7.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-7 0}ul.lst-kix_h2g10xayxpic-3{list-style-type:none}.lst-kix_ao7i0ho19mha-6>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-6,decimal) ". "}.lst-kix_8fr0hoifq0ng-7>li:before{content:"\0025cb  "}ul.lst-kix_h2g10xayxpic-2{list-style-type:none}ul.lst-kix_h2g10xayxpic-1{list-style-type:none}.lst-kix_8fr0hoifq0ng-6>li:before{content:"\0025cf  "}ul.lst-kix_h2g10xayxpic-0{list-style-type:none}.lst-kix_ao7i0ho19mha-3>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-3,decimal) ". "}.lst-kix_ao7i0ho19mha-5>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-5,lower-roman) ". "}.lst-kix_8fr0hoifq0ng-5>li:before{content:"\0025a0  "}.lst-kix_h2g10xayxpic-1>li:before{content:"\0025cb  "}.lst-kix_ao7i0ho19mha-4>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-4,lower-latin) ". "}.lst-kix_8fr0hoifq0ng-3>li:before{content:"\0025cf  "}.lst-kix_8fr0hoifq0ng-2>li:before{content:"\0025a0  "}.lst-kix_8fr0hoifq0ng-4>li:before{content:"\0025cb  "}.lst-kix_ao7i0ho19mha-1>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-1,lower-latin) ". "}.lst-kix_ao7i0ho19mha-2>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-2,lower-roman) ". "}.lst-kix_8fr0hoifq0ng-0>li:before{content:"\0025cf  "}.lst-kix_8fr0hoifq0ng-1>li:before{content:"\0025cb  "}.lst-kix_ao7i0ho19mha-0>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-0,decimal) ". "}.lst-kix_82qvx0uu1n4r-6>li:before{content:"\0025cf  "}.lst-kix_44an8rwzua74-6>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-6,decimal) ". "}.lst-kix_44an8rwzua74-7>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-7,lower-latin) ". "}.lst-kix_82qvx0uu1n4r-5>li:before{content:"\0025a0  "}.lst-kix_82qvx0uu1n4r-7>li:before{content:"\0025cb  "}.lst-kix_82qvx0uu1n4r-4>li:before{content:"\0025cb  "}.lst-kix_82qvx0uu1n4r-8>li:before{content:"\0025a0  "}.lst-kix_44an8rwzua74-4>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-4,lower-latin) ". "}.lst-kix_44an8rwzua74-8>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-8,lower-roman) ". "}ol.lst-kix_ao7i0ho19mha-6.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-6 0}.lst-kix_44an8rwzua74-5>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-5,lower-roman) ". "}.lst-kix_44an8rwzua74-7>li{counter-increment:lst-ctn-kix_44an8rwzua74-7}.lst-kix_44an8rwzua74-6>li{counter-increment:lst-ctn-kix_44an8rwzua74-6}.lst-kix_ao7i0ho19mha-8>li:before{content:"" counter(lst-ctn-kix_ao7i0ho19mha-8,lower-roman) ". "}ul.lst-kix_82qvx0uu1n4r-8{list-style-type:none}.lst-kix_44an8rwzua74-5>li{counter-increment:lst-ctn-kix_44an8rwzua74-5}ul.lst-kix_82qvx0uu1n4r-7{list-style-type:none}ol.lst-kix_44an8rwzua74-7.start{counter-reset:lst-ctn-kix_44an8rwzua74-7 0}ul.lst-kix_82qvx0uu1n4r-0{list-style-type:none}.lst-kix_ao7i0ho19mha-4>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-4}ul.lst-kix_82qvx0uu1n4r-2{list-style-type:none}ul.lst-kix_82qvx0uu1n4r-1{list-style-type:none}ul.lst-kix_82qvx0uu1n4r-4{list-style-type:none}.lst-kix_ao7i0ho19mha-2>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-2}ul.lst-kix_82qvx0uu1n4r-3{list-style-type:none}ul.lst-kix_82qvx0uu1n4r-6{list-style-type:none}ul.lst-kix_82qvx0uu1n4r-5{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-3{list-style-type:none}ol.lst-kix_44an8rwzua74-4.start{counter-reset:lst-ctn-kix_44an8rwzua74-4 0}ul.lst-kix_8fr0hoifq0ng-4{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-1{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-2{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-7{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-8{list-style-type:none}.lst-kix_44an8rwzua74-0>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-0,decimal) ". "}ul.lst-kix_8fr0hoifq0ng-5{list-style-type:none}ul.lst-kix_8fr0hoifq0ng-6{list-style-type:none}.lst-kix_44an8rwzua74-2>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-2,lower-roman) ". "}.lst-kix_44an8rwzua74-3>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-3,decimal) ". "}ul.lst-kix_8fr0hoifq0ng-0{list-style-type:none}.lst-kix_44an8rwzua74-1>li:before{content:"" counter(lst-ctn-kix_44an8rwzua74-1,lower-latin) ". "}.lst-kix_44an8rwzua74-8>li{counter-increment:lst-ctn-kix_44an8rwzua74-8}ol.lst-kix_44an8rwzua74-1.start{counter-reset:lst-ctn-kix_44an8rwzua74-1 0}.lst-kix_ao7i0ho19mha-0>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-0}ol.lst-kix_44an8rwzua74-8.start{counter-reset:lst-ctn-kix_44an8rwzua74-8 0}ul.lst-kix_ng8knyk2ieud-6{list-style-type:none}ul.lst-kix_ng8knyk2ieud-7{list-style-type:none}ul.lst-kix_ng8knyk2ieud-4{list-style-type:none}ul.lst-kix_ng8knyk2ieud-5{list-style-type:none}ul.lst-kix_ng8knyk2ieud-2{list-style-type:none}ul.lst-kix_ng8knyk2ieud-3{list-style-type:none}ul.lst-kix_ng8knyk2ieud-0{list-style-type:none}ul.lst-kix_ng8knyk2ieud-1{list-style-type:none}ol.lst-kix_ao7i0ho19mha-4.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-4 0}.lst-kix_44an8rwzua74-3>li{counter-increment:lst-ctn-kix_44an8rwzua74-3}ul.lst-kix_ng8knyk2ieud-8{list-style-type:none}ol.lst-kix_ao7i0ho19mha-8{list-style-type:none}ol.lst-kix_44an8rwzua74-2.start{counter-reset:lst-ctn-kix_44an8rwzua74-2 0}ol.lst-kix_ao7i0ho19mha-2{list-style-type:none}ol.lst-kix_ao7i0ho19mha-3{list-style-type:none}ol.lst-kix_ao7i0ho19mha-0{list-style-type:none}ol.lst-kix_ao7i0ho19mha-1{list-style-type:none}ol.lst-kix_ao7i0ho19mha-6{list-style-type:none}ol.lst-kix_44an8rwzua74-3{list-style-type:none}ol.lst-kix_ao7i0ho19mha-7{list-style-type:none}ol.lst-kix_44an8rwzua74-2{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_ao7i0ho19mha-4{list-style-type:none}ol.lst-kix_44an8rwzua74-1{list-style-type:none}ol.lst-kix_ao7i0ho19mha-5{list-style-type:none}ol.lst-kix_44an8rwzua74-0{list-style-type:none}ol.lst-kix_44an8rwzua74-7{list-style-type:none}ol.lst-kix_44an8rwzua74-6{list-style-type:none}ol.lst-kix_44an8rwzua74-5{list-style-type:none}ol.lst-kix_ao7i0ho19mha-3.start{counter-reset:lst-ctn-kix_ao7i0ho19mha-3 0}ol.lst-kix_44an8rwzua74-4{list-style-type:none}.lst-kix_82qvx0uu1n4r-0>li:before{content:"\0025cf  "}ol.lst-kix_44an8rwzua74-8{list-style-type:none}.lst-kix_82qvx0uu1n4r-2>li:before{content:"\0025a0  "}.lst-kix_82qvx0uu1n4r-1>li:before{content:"\0025cb  "}.lst-kix_82qvx0uu1n4r-3>li:before{content:"\0025cf  "}.lst-kix_ao7i0ho19mha-6>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-6}.lst-kix_ao7i0ho19mha-3>li{counter-increment:lst-ctn-kix_ao7i0ho19mha-3}ol{margin:0;padding:0}table td,table th{padding:0}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c19{background-color:#ffffff;color:#272822;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c13{padding-top:0pt;padding-bottom:-1pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c16{padding-top:18pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{padding-top:12pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c24{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c6{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c15{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt}.c22{color:#000000;text-decoration:none;vertical-align:baseline;font-size:17pt;font-style:normal}.c20{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt}.c7{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c18{font-weight:400;vertical-align:baseline;font-size:11pt;font-style:normal}.c23{background-color:#ffffff;font-size:10.5pt;font-family:"Roboto"}.c21{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c11{padding:0;margin:0}.c5{font-weight:400;font-family:"Courier New"}.c9{margin-left:36pt;padding-left:0pt}.c14{color:inherit;text-decoration:inherit}.c10{font-family:"Arial"}.c17{height:16pt}.c4{font-weight:700}.c12{height:11pt}.c8{font-style:italic}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c21 doc-content"><h2 class="c16" id="h.2tgv1f5enyvv"><span class="c22 c10 c4">What you&#39;ll learn</span></h2><ul class="c11 lst-kix_82qvx0uu1n4r-0 start"><li class="c3 c9 li-bullet-0"><span class="c1">The four most common Grant Types from OAuth.</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Create and manage applications in Okta.</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Securing an existing API using Anypoint Platform.</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Create a Mule App in Anypoint Studio to retrieve tokens implementing the four Grant Types flows.</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Test the application and interact with the API using an access token.</span></li></ul><h2 class="c16" id="h.1kzvqhdmn1bk"><span class="c10 c4 c22">What you&#39;ll need</span></h2><ul class="c11 lst-kix_ng8knyk2ieud-0 start"><li class="c3 c9 li-bullet-0"><span class="c1">Anypoint Platform account</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Anypoint Studio (last version available)</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Okta Developer account</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Postman (or another API Testing app)</span></li></ul><p class="c3"><span class="c4">Note</span><span class="c1">: If you aren&#39;t using Postman, you probably won&#39;t have the same functionality as the explanation requires. So, for a better experience, download it!</span></p><p class="c3"><span class="c1">In this Codelab we are going to learn the four most common grant types from OAuth and how to implement each flow using Anypoint Studio and the OAuth connector. These grant types are:</span></p><ul class="c11 lst-kix_8fr0hoifq0ng-0 start"><li class="c3 c9 li-bullet-0"><span class="c1">Client Credentials</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Authorization Code</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Resource Owner Password</span></li><li class="c3 c9 li-bullet-0"><span class="c1">Implicit</span></li></ul><p class="c3"><span>The important thing to remember is that both </span><span class="c4">client credentials</span><span>&nbsp;and </span><span class="c4">resource owner password</span><span>&nbsp;flows are </span><span class="c8">non-interactive</span><span>. Meaning that the final user (a.k.a. </span><span class="c8">resource owner</span><span class="c1">) doesn&#39;t have to interact once the token request is sent. These Grant Types are mainly used for service-to-service integrations where there is no human intervention.</span></p><p class="c3"><span>On the other hand, </span><span class="c4">authorization code</span><span>&nbsp;and </span><span class="c4">implicit</span><span>&nbsp;flows are </span><span class="c8">interactive</span><span class="c1">. At some point, the resource owner will be asked to login to Okta and identify who they are. These Grant Types are used on interactive applications, like web or mobile, to get a token securing the resource owner credentials (they never go though the Client App).</span></p><h2 class="c16 c17" id="h.9yv6ag72bpt0"><span class="c22 c10 c4"></span></h2><h2 class="c16 c17" id="h.uosyd8g1iifk"><span class="c22 c10 c4"></span></h2><h2 class="c16" id="h.xofu05nuwadn"><span class="c22 c10 c4">Differences Between OAuth2 Grant Type Flow Diagrams</span></h2><p class="c3"><span class="c1">In principle, the Get Access Token flow has 5 steps (as shown in the diagram below):</span></p><ol class="c11 lst-kix_44an8rwzua74-0 start" start="1"><li class="c3 c9 li-bullet-0"><span class="c1">Pre-register Client (App) with OAuth Server to get Client ID/Client Secret</span></li><li class="c3 c9 li-bullet-0"><span class="c1">OAuth Server authenticates users presenting a login page. Sometimes it also receives the App&#39;s Client ID.</span></li><li class="c3 c9 li-bullet-0"><span class="c1">OAuth Server solicits user permission (consent) to allow the App to perform something on her behalf</span></li><li class="c3 c9 li-bullet-0"><span class="c1">OAuth Server sends secret Code (a.k.a. Authorization Code) to App</span></li><li class="c3 c9 li-bullet-0"><span>App acquires Key/Access Token from OAuth Server by presenting secret Code and Client Secret </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 353.33px;"><img alt="" src="images/image74.png" style="width: 624.00px; height: 353.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c3"><span class="c1">If you want to learn more about these diagrams and Grant Types in OAuth visit this link:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=https://blog.oauth.io/introduction-oauth2-flow-diagrams/&amp;sa=D&amp;source=editors&amp;ust=1668189535990246&amp;usg=AOvVaw2NDxiLsZv6KWdDiKtdUwms">https://blog.oauth.io/introduction-oauth2-flow-diagrams/</a></span></p><p class="c3"><span class="c1">However, later on, we will have a deeper look and see how each grant type works in detail.</span></p><p class="c3"><span class="c1">In this Step, we are going to create two Apps in Okta (a Web and a Native app) to later interact with them from a Mule App we are going to create. The type of the app will enable specific Grant Types that make sense for each scenario.</span></p><p class="c3"><span class="c1">We will configure each app with their callbacks, Grant Types allowed, scopes, etc.</span></p><p class="c3"><span class="c4">1. </span><span class="c1">First of all, you will need to create an Okta developer account. Later on, we will create and manage applications from Okta.</span></p><p class="c3"><span class="c1">Get the trial account here:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=https://developer.okta.com/signup/&amp;sa=D&amp;source=editors&amp;ust=1668189535991282&amp;usg=AOvVaw2s7EOUYEyHyMD5vxwXeaC4">Okta Developer Account</a></span></p><p class="c3"><span class="c4">2. </span><span>Create a Web App in Okta. We will name it </span><span class="c4 c23">oauth-grant-types</span><span>. </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 450.67px;"><img alt="" src="images/image100.png" style="width: 624.00px; height: 450.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 382.67px;"><img alt="" src="images/image19.png" style="width: 624.00px; height: 382.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 428.00px;"><img alt="" src="images/image98.png" style="width: 624.00px; height: 428.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 286.67px;"><img alt="" src="images/image39.png" style="width: 624.00px; height: 286.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>Click </span><span class="c4">Save</span><span class="c1">&nbsp;when finished.</span></p><p class="c3"><span>As you can see from the screenshot above, we have set this client application for both </span><span class="c4">Client Credentials </span><span>as well as for </span><span class="c4">Authorization Code</span><span>&nbsp;OAuth 2.0 grants and have assigned this app to &lsquo;</span><span class="c4">Everyone</span><span class="c1">&#39;.</span></p><p class="c3"><span>For this app, we are only going to implement the </span><span class="c4">Client Credentials </span><span class="c1">grant type.</span></p><p class="c3"><span class="c4">3.</span><span>&nbsp;You will land in the </span><span class="c4">General</span><span>&nbsp;tab of your application. From here, take a note of the</span><span class="c4">&nbsp;Client ID</span><span>&nbsp;and </span><span class="c4">Client Secret</span><span class="c1">&nbsp;generated. We will use them later.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 506.67px;"><img alt="" src="images/image78.png" style="width: 624.00px; height: 506.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">4.</span><span>&nbsp;Add a </span><span class="c4">Custom Scope</span><span>&nbsp;for the </span><span class="c6 c4 c10">Web App.</span></p><p class="c3"><span>Go to </span><span class="c4">Security</span><span>&nbsp;&rarr; </span><span class="c4">API</span><span>&nbsp;&rarr; </span><span class="c4">Authorization Servers </span><span>&rarr; Click on </span><span class="c4">Default</span><span>&nbsp;&rarr; </span><span class="c6 c10 c4">Scopes</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 224.00px;"><img alt="" src="images/image80.png" style="width: 624.00px; height: 224.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 560.00px;"><img alt="" src="images/image41.png" style="width: 624.00px; height: 560.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>We&#39;ll need to use this </span><span class="c4">mule-scope</span><span class="c1">&nbsp;later on this exercise to properly retrieve an access token.</span></p><p class="c0"><span class="c6 c10 c4"></span></p><p class="c2"><span class="c4">5.</span><span>&nbsp;Now, similarly as with the </span><span class="c4">Web App</span><span>, we&#39;ll create a </span><span class="c4">Native App</span><span>&nbsp;in Okta. We&#39;ll name it </span><span class="c4">Native App</span><span>. </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 453.33px;"><img alt="" src="images/image16.png" style="width: 624.00px; height: 453.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>And select all the grant types (just in case we need them in the future). </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 400.00px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 400.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>Click </span><span class="c4">Save</span><span>&nbsp;when finished. For this app, we are going to implement the other three grant types: </span><span class="c4">Authorization Code</span><span>, </span><span class="c4">Resource Owner Password</span><span>&nbsp;and </span><span class="c4">Implicit</span><span class="c1">.</span></p><p class="c3"><span class="c1">Take a note of the Client ID and Client Secret from this app, we&#39;ll need them later.</span></p><p class="c3"><span class="c4">Note</span><span>: My recommendation is to keep track of </span><span class="c8">Client IDs</span><span>, </span><span class="c8">Client Secrets</span><span>, </span><span class="c8">URLs</span><span class="c1">, etc. And have them all in a text editor (like VS Code). It is easier to access them and we will definitely use them later.</span></p><p class="c2"><span class="c6 c10 c4">Note: for oauth native api make you uncheck Proof Key for Code Exchange (PKCE)</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 354.67px;"><img alt="" src="images/image107.png" style="width: 624.00px; height: 354.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">6.</span><span>&nbsp;Add a </span><span class="c4">Callback URI</span><span>&nbsp;for the </span><span class="c6 c10 c4">Native App.</span></p><p class="c3"><span>Go to the </span><span class="c8">General Settings</span><span>&nbsp;of the </span><span class="c4">Native App</span><span class="c1">&nbsp;and from there Edit them.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 506.67px;"><img alt="" src="images/image14.png" style="width: 624.00px; height: 506.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Add: </span><span class="c4 c7"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/login/callback&amp;sa=D&amp;source=editors&amp;ust=1668189535995848&amp;usg=AOvVaw27PjjWcfDJ6g1lhiD_sjVH">http://localhost:8081/login/callback</a></span></p><p class="c0"><span class="c6 c10 c4"></span></p><p class="c3"><span class="c1">Now, we&#39;re all set and ready to move on to the next step!</span></p><p class="c3"><span class="c1">In this step, we are going to use a public API and then secure it by creating a proxy with Anypoint Platform. This will enforce the client to send a valid token to access the API.</span></p><p class="c3"><span class="c1">We&#39;ll use this API to test the scenarios we develop later.</span></p><p class="c3"><span class="c1">The API we&#39;ll be using is Random User API.</span></p><p class="c3"><span class="c4">1. </span><span class="c1">Check that the API is working properly from your browser:</span></p><p class="c2"><span class="c1">https://randomuser.me/api/</span></p><p class="c3"><span class="c1">It returns information about a random fake user, including gender, name, email, address, etc.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 92.00px;"><img alt="" src="images/image91.png" style="width: 624.00px; height: 92.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">The important thing here is securing the API, not the API itself. So, let&#39;s secure it.</span></p><p class="c3"><span>2. First, we are going to manage the Random User API from </span><span class="c10 c8 c15">API Manager </span></p><p class="c3"><span class="c8">Go to </span><span class="c4 c8">Anypoint Platform &rarr; Management Center&rarr; API Manager</span><span class="c15 c10 c8">.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 223.68px;"><img alt="" src="images/image58.png" style="width: 624.00px; height: 223.68px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c12"><span class="c15 c10 c8"></span></p><p class="c3 c12"><span class="c15 c10 c8"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 311.50px;"><img alt="" src="images/image90.png" style="width: 624.00px; height: 311.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Select Mule Gateway and check proxy type as </span><span class="c4">Deploy a proxy Application</span><span>,</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 160.00px;"><img alt="" src="images/image34.png" style="width: 624.00px; height: 160.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">Provide proxy application name and click Next</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 248.00px;"><img alt="" src="images/image31.png" style="width: 624.00px; height: 248.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Click </span><span class="c4">Create new API </span><span>and provide Name and Asset type as </span><span class="c4">HTTP API</span><span class="c1">, click Next</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 308.00px;"><img alt="" src="images/image26.png" style="width: 624.00px; height: 308.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 302.67px;"><img alt="" src="images/image59.png" style="width: 624.00px; height: 302.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">WARNING: </span><span>In my case I&#39;m using a Client Provider that I created before. You can check out this article regarding that </span><span class="c7"><a class="c14" href="https://www.google.com/url?q=https://conflowence.atlassian.net/l/cp/NKAof9L7&amp;sa=D&amp;source=editors&amp;ust=1668189535998639&amp;usg=AOvVaw1hRTfWiwH0yStkXa2bcJIi">https://conflowence.atlassian.net/l/cp/NKAof9L7</a></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>And then </span><span class="c4">Save and Deploy. </span><span class="c1">Then you will land on this page.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 182.67px;"><img alt="" src="images/image108.png" style="width: 624.00px; height: 182.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">Wait until the deployment is successful.</span></p><p class="c3"><span class="c4">3.</span><span>&nbsp;Now that our Proxy has been successfully deployed to </span><span class="c4">CloudHub</span><span>, it&#39;s time to apply some </span><span class="c8">policy</span><span class="c1">.</span></p><p class="c3"><span>Go to </span><span class="c10 c4 c8 c20">Policies &rarr; Apply New Policy &rarr; Click JWT Validation click Next</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 326.67px;"><img alt="" src="images/image11.png" style="width: 624.00px; height: 326.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 150.67px;"><img alt="" src="images/image37.png" style="width: 624.00px; height: 150.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 405.33px;"><img alt="" src="images/image64.png" style="width: 624.00px; height: 405.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 402.67px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 402.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Check </span><span class="c4">JWKS </span><span class="c1">Then, in the JWKS Url add yours:</span></p><p class="c2"><span class="c1">https://dev-********.okta.com/oauth2/default/v1/keys</span></p><p class="c3"><span class="c4">Note</span><span>: You can find this url in your Okta in the metadata of the </span><span class="c8">default</span><span class="c1">&nbsp;Auth Server. In my case the metadata URL is https://dev-********.okta.com/oauth2/default/.well-known/oauth-authorization-server (replacing the asterisks with your dev numbers).</span></p><p class="c3"><span>Also, select </span><span class="c4">Skip Client ID Validation</span><span class="c1">.</span></p><p class="c3"><span>The other default values leave them as they are and select </span><span class="c4">Apply</span><span class="c1">.</span></p><p class="c2"><span class="c1">The policy configuration is ready.</span></p><p class="c2"><span class="c4">Note</span><span class="c1">: It may take a few minutes for the changes to be reflected in the Proxy, so wait a little before checking if the Policy is already working.</span></p><p class="c3"><span class="c4">4.</span><span>&nbsp;Now, from your browser or Postman you can try to call the API and you&#39;ll see that the </span><span class="c4">Token Enforcement Policy</span><span class="c1">&nbsp;is already working.</span></p><p class="c3"><span class="c1">The Proxy URL in my case is:</span></p><p class="c13"><span class="c10 c19">Copy</span></p><p class="c2"><span class="c1">http://random-user-api-ae.us-e2.cloudhub.io/</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Use your URL and see what happens:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 389.33px;"><img alt="" src="images/image15.png" style="width: 624.00px; height: 389.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Our API is effectively secured!</span></p><p class="c3"><span>Now, we are able to pass to the next step that is</span><span class="c4">&nbsp;getting a token </span><span class="c1">to access this Random User API.</span></p><p class="c3"><span class="c1">First of all, in this step, we are going to prepare everything in Studio. Building the skeleton of the project, adding some modules from Exchange, adding some dependencies, etc. Mostly paving the way before implementing the different Grant Types.</span></p><p class="c3"><span>If you want to skip this step you can download the </span><span class="c4">.jar</span><span>&nbsp;from the repository in </span><span class="c4">GitHub</span><span>&nbsp;where this </span><span class="c4">Codelab</span><span class="c1">&nbsp;is fully implemented.</span></p><p class="c3"><span>Go to the folder docs and download the </span><span class="c4">jar </span><span>&quot;oauth-template&quot; and move on to </span><span class="c4">Step 6</span><span class="c1">&nbsp;to start implementing.</span></p><p class="c2"><span class="c7"><a class="c14" href="https://www.google.com/url?q=https://github.com/Conflowence-POC/oauth-grant-types-examples.git&amp;sa=D&amp;source=editors&amp;ust=1668189536003009&amp;usg=AOvVaw1_7xWVw7sqlYpZxCZmerTW">https://github.com/Conflowence-POC/oauth-grant-types-examples.git</a></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">If you want to learn how to prepare Studio, just follow these steps!</span></p><p class="c2"><span class="c4">1. </span><span>Open </span><span class="c4">Anypoint Studio</span><span>&nbsp;and create a new </span><span class="c4">Mule Project</span><span>.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 533.33px;"><img alt="" src="images/image47.png" style="width: 624.00px; height: 533.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 473.33px;"><img alt="" src="images/image56.png" style="width: 624.00px; height: 473.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">2.</span><span>&nbsp;Import the </span><span class="c4">OAuth Module</span><span class="c1">:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 614.00px; height: 314.00px;"><img alt="" src="images/image67.png" style="width: 614.00px; height: 314.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 550.67px;"><img alt="" src="images/image57.png" style="width: 624.00px; height: 550.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 604.00px; height: 408.00px;"><img alt="" src="images/image99.png" style="width: 604.00px; height: 408.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 469.33px;"><img alt="" src="images/image13.png" style="width: 624.00px; height: 469.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 505.33px;"><img alt="" src="images/image54.png" style="width: 624.00px; height: 505.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">In this file copy this template:</span></p><p class="c2"><span class="c1">native_app: </span></p><p class="c2"><span class="c1">&nbsp; client_id: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_secret: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; redirect_uri: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; scope: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; auth_code: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; login_callback_path: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; external_callback_url: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; local_auth_url: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; implicit: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; redirect_uri: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; state: &quot;&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">web_app: </span></p><p class="c2"><span class="c1">&nbsp; client_id: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_secret: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_credentials: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; scope: &quot;&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">okta: </span></p><p class="c2"><span class="c1">&nbsp; username: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; password: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; token_url: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; token_path: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; auth_url: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; domain: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; port: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; </span></p><p class="c2"><span class="c1">api: </span></p><p class="c2"><span class="c1">&nbsp; url: &quot;&quot;</span></p><p class="c2"><span class="c1">&nbsp; </span></p><p class="c2"><span class="c1">static_resource:</span></p><p class="c2"><span class="c1">&nbsp; path: &quot;&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">4. </span><span>For getting the info to fill out the template, we need to go back to </span><span class="c4 c8">Okta</span><span class="c1">.</span></p><p class="c2"><span>Go to </span><span class="c4">Security &rarr; API &rarr; Authorization Servers</span><span>&nbsp;and click on the </span><span class="c4">default</span><span class="c1">&nbsp;auth server.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 278.67px;"><img alt="" src="images/image50.png" style="width: 624.00px; height: 278.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">The link with the Metadata URL contains all the URLs you need. Click on it and take a note of the ones we need:</span></p><ul class="c11 lst-kix_h2g10xayxpic-0 start"><li class="c3 c9 li-bullet-0"><span class="c15 c10 c8">Authorization URL</span></li><li class="c3 c9 li-bullet-0"><span class="c15 c10 c8">Token URL</span></li></ul><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 406.67px;"><img alt="" src="images/image111.png" style="width: 624.00px; height: 406.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">5.</span><span class="c1">&nbsp;Fill it out with all the info requested that we&#39;ll use later in this exercise. It should look something like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 548.00px;"><img alt="" src="images/image106.png" style="width: 624.00px; height: 548.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">Or </span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">native_app: </span></p><p class="c2"><span class="c1">&nbsp; client_id: &quot;0oa433g3taIv6K8sq5d7&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_secret: &quot;****************&quot;</span></p><p class="c2"><span class="c1">&nbsp; redirect_uri: &quot;http://localhost:8081/login/callback&quot;</span></p><p class="c2"><span class="c1">&nbsp; scope: &quot;openid offline_access&quot;</span></p><p class="c2"><span class="c1">&nbsp; auth_code: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; login_callback_path: &quot;/login/callback&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; external_callback_url: &quot;http://localhost:8081/login/callback&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; local_auth_url: &quot;http://localhost:8081/login&quot;</span></p><p class="c2"><span class="c1">&nbsp; implicit: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; redirect_uri: &quot;http://localhost:8081/implicit-login/callback&quot;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; state: &quot;state-296bc9a0-a2a2-4a57-be1a-d0e2fd9bb601&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">web_app: </span></p><p class="c2"><span class="c1">&nbsp; client_id: &quot;0oa433d1ff5soQ1VH5d7&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_secret: &quot;************&quot;</span></p><p class="c2"><span class="c1">&nbsp; client_credentials: </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; scope: &quot;custom_scope&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">okta: </span></p><p class="c2"><span class="c1">&nbsp; username: &quot;(your okta username)&quot;</span></p><p class="c2"><span class="c1">&nbsp; password: &quot;************&quot;</span></p><p class="c2"><span class="c1">&nbsp; token_url: &quot;https://dev-********.okta.com/oauth2/default/v1/token&quot;</span></p><p class="c2"><span class="c1">&nbsp; token_path: &quot;oauth2/default/v1/token&quot;</span></p><p class="c2"><span class="c1">&nbsp; auth_url: &quot;https://dev-********.okta.com/oauth2/default/v1/authorize&quot;</span></p><p class="c2"><span class="c1">&nbsp; domain: &quot;dev-********.okta.com&quot;</span></p><p class="c2"><span class="c1">&nbsp; port: &quot;443&quot;</span></p><p class="c2"><span class="c1">&nbsp; </span></p><p class="c2"><span class="c1">api: </span></p><p class="c2"><span class="c1">&nbsp; url: &quot;http://random-user-api-**.us-e2.cloudhub.io/&quot;</span></p><p class="c2"><span class="c1">&nbsp; </span></p><p class="c2"><span class="c1">static_resource:</span></p><p class="c2"><span class="c1">&nbsp; path: &quot;(to do later)&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">Note 1</span><span class="c1">: Replace with your info the ****.</span></p><p class="c3"><span class="c4">Note 2</span><span>: The </span><span class="c4 c8">static_resource</span><span class="c1">&nbsp;part leave it blank right now. We will come back to this later.</span></p><p class="c3"><span class="c4">6. </span><span>Add a </span><span class="c4">Global Configuration Element</span><span>&nbsp;for the </span><span class="c4">config.yaml</span><span class="c1">.</span></p><p class="c3"><span>From the </span><span class="c4">oauth_test.xml</span><span>&nbsp;go to </span><span class="c4">Global Elements</span><span>&nbsp;and </span><span class="c4">Create</span><span class="c1">&nbsp;a new one:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 617.33px;"><img alt="" src="images/image12.png" style="width: 624.00px; height: 617.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 625.33px;"><img alt="" src="images/image22.png" style="width: 624.00px; height: 625.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">7. </span><span>Now, we are going to create an </span><span class="c4">Object Store</span><span>&nbsp;to keep record of the </span><span class="c4">Tokens</span><span class="c1">&nbsp;we will be obtaining.</span></p><p class="c3"><span class="c1">This is how the flow will look like:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 448.00px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 448.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>The </span><span class="c4">Listener</span><span>&nbsp;is configured with the </span><span class="c4 c8">default</span><span>&nbsp;global configuration (</span><span class="c8">HTTP_Listener_config</span><span class="c1">) and the path will be /tokens.</span></p><p class="c3"><span>For the </span><span class="c4">Retrieve all</span><span>&nbsp;operation we need to import the </span><span class="c4">ObjectStore</span><span class="c1">&nbsp;connector from Exchange:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 544.00px;"><img alt="" src="images/image72.png" style="width: 624.00px; height: 544.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>And, in the </span><span class="c4">Retrieve all</span><span>&nbsp;operation, configure the </span><span class="c4">Object Store</span><span>&nbsp;by creating a new </span><span class="c4">Token Manager</span><span>&nbsp;(to save and manage all tokens) called </span><span class="c4">Tokens</span><span class="c1">:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 617.33px;"><img alt="" src="images/image45.png" style="width: 624.00px; height: 617.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 137.33px;"><img alt="" src="images/image102.png" style="width: 624.00px; height: 137.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Finally, </span><span class="c4">Transform</span><span class="c1">&nbsp;data into JSON:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 572.00px; height: 282.00px;"><img alt="" src="images/image23.png" style="width: 572.00px; height: 282.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">8. </span><span class="c1">Finally, we are going to create a flow to invalidate the stored tokens. To later on, show properly how each Grant Type works, without skipping the part of getting an access token.</span></p><p class="c3"><span class="c1">Let&#39;s create a flow and name it invalidate:</span></p><p class="c3"><span class="c1">It would look like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 446.00px; height: 492.00px;"><img alt="" src="images/image93.png" style="width: 446.00px; height: 492.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>The </span><span class="c4">Listener</span><span>&nbsp;would have the global</span><span class="c8">&nbsp;HTTP_Listener_config</span><span class="c1">&nbsp;and the path will be /invalidate.</span></p><p class="c3"><span>The </span><span class="c4">Clear</span><span class="c1">&nbsp;operation will have an Object Store Tokens:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 117.33px;"><img alt="" src="images/image46.png" style="width: 624.00px; height: 117.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>Studio is all set right now. We are ready to implement the different flows for the four </span><span class="c4">Grant Types</span><span class="c1">&nbsp;we are learning!</span></p><p class="c3"><span>The first grant type we are going to implement is </span><span class="c4">Client Credentials</span><span class="c1">. We are using the Web App and our Random User API.</span></p><p class="c3"><span class="c4">1. </span><span>Create a new flow and name it </span><span class="c4">client_credentials</span><span class="c1">.</span></p><p class="c3"><span class="c1">This will be the final flow:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 462.00px; height: 484.00px;"><img alt="" src="images/image82.png" style="width: 462.00px; height: 484.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">2. </span><span>So, first drag a </span><span class="c4">Listener</span><span>&nbsp;and select the default global configuration (</span><span class="c8">HTTP_Listener_config</span><span class="c1">) and set the path to /client_credentials. Just like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 114.67px;"><img alt="" src="images/image88.png" style="width: 624.00px; height: 114.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">3. </span><span>Drag a </span><span class="c4">Request</span><span class="c1">&nbsp;and configure it.</span></p><p class="c3"><span class="c4">Note</span><span>: The Request configuration will inherit some features from the </span><span class="c4">OAuth</span><span>&nbsp;module we&#39;ve just imported. So, the </span><span class="c4">client credentials</span><span>&nbsp;and </span><span class="c4">authorization code</span><span class="c1">&nbsp;flows can be configured almost automatically.</span></p><p class="c3"><span>Configure the </span><span class="c8">global configuration </span><span class="c1">for the HTTP Request:</span></p><p class="c3"><span class="c1">(these are the values you&#39;ll have to copy and paste)</span></p><p class="c13"><span class="c19 c10">Copy</span></p><p class="c2"><span class="c1">Name: HTTP_Request_configuration-Client_Credentials</span></p><p class="c2"><span class="c1">Client id: ${web_app.client_id}</span></p><p class="c2"><span class="c1">Client secret: ${web_app.client_secret}</span></p><p class="c2"><span class="c1">Scopes: ${web_app.client_credentials.scope}</span></p><p class="c2"><span class="c1">Token url: ${okta.token_url}</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 553.33px;"><img alt="" src="images/image17.png" style="width: 624.00px; height: 553.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Select </span><span class="c4">Tokens</span><span>&nbsp;for the </span><span class="c4">Object Store</span><span class="c1">&nbsp;configuration:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 462.67px;"><img alt="" src="images/image83.png" style="width: 624.00px; height: 462.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>And finish the </span><span class="c8">Request configuration</span><span class="c1">:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 285.33px;"><img alt="" src="images/image44.png" style="width: 624.00px; height: 285.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">4. </span><span>The other part of the </span><span class="c4">Request</span><span class="c1">&nbsp;configuration will be the following:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c6 c5">URL: ${api.url}</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 209.33px;"><img alt="" src="images/image97.png" style="width: 624.00px; height: 209.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c3"><span class="c4">5. </span><span>Now, we are able to </span><span class="c4">test</span><span class="c1">&nbsp;this first flow and see what happens...</span></p><p class="c3"><span>Go to </span><span class="c4">Postman</span><span>&nbsp;(or any other application that allows the testing of web APIs, like ARC) and make a </span><span class="c4">GET</span><span class="c1">&nbsp;request:</span></p><p class="c3"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/client_credentials&amp;sa=D&amp;source=editors&amp;ust=1668189536018595&amp;usg=AOvVaw1ru5oodTSdKkdltZ_XFSQ_">http://localhost:8081/client_credentials</a></span><span class="c5">&nbsp;(you can find postman api json file under src/test/resources of the github project)</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 446.67px;"><img alt="" src="images/image85.png" style="width: 624.00px; height: 446.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">The response is right there!</span></p><p class="c3"><span>So far so good. Let&#39;s move on to the next </span><span class="c8">Grant Type: </span><span class="c1">Authorization Code!</span></p><p class="c3"><span>For this Grant Type we are going to use the Native App created in </span><span class="c4">Okta</span><span class="c1">.</span></p><p class="c3"><span class="c4">1. </span><span class="c1">Create a new flow and name it auth_code:</span></p><p class="c3"><span class="c1">At the end it will look like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 460.00px; height: 502.00px;"><img alt="" src="images/image43.png" style="width: 460.00px; height: 502.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c4">2. </span><span>Drag a </span><span class="c4">Listener</span><span class="c1">, choose the HTTP_Listener_config and set the path to /auth_code.</span></p><p class="c3"><span>Then drag a </span><span class="c4">Request</span><span class="c1">&nbsp;and configure it:</span></p><p class="c2"><span class="c1">Name: HTTP_Request_configuration-Auth_Code</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 550.67px;"><img alt="" src="images/image33.png" style="width: 624.00px; height: 550.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Authentication: Authorization code grant type</span></p><p class="c2"><span class="c1">Local callback config: HTTP_Listener_config</span></p><p class="c2"><span class="c1">Local callback config path: ${native_app.auth_code.login_callback_path}</span></p><p class="c2"><span class="c1">External callback url: ${native_app.auth_code.external_callback_url}</span></p><p class="c2"><span class="c1">Local authorization url: ${native_app.auth_code.local_auth_url}</span></p><p class="c2"><span class="c1">Authorization url: ${okta.auth_url}</span></p><p class="c2"><span class="c1">Custom parameters: Edit inline (and add some state)</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 502.67px;"><img alt="" src="images/image76.png" style="width: 624.00px; height: 502.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Client id: ${native_app.client_id}</span></p><p class="c2"><span class="c1">Client secret: ${native_app.client_secret}</span></p><p class="c2"><span class="c1">Scopes: ${native_app.scope}</span></p><p class="c2"><span class="c1">Token Manager: Same as in Client Credentials. Add &quot;Tokens&quot; to the Object Store.</span></p><p class="c2"><span class="c1">Token url: ${okta.token_url}</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 501.33px;"><img alt="" src="images/image92.png" style="width: 624.00px; height: 501.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">And finish the configuration:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 276.00px;"><img alt="" src="images/image18.png" style="width: 624.00px; height: 276.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">3. </span><span>Add the API </span><span class="c8">URL</span><span>&nbsp;to the </span><span class="c4">Request</span><span class="c1">.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c6 c5">URL: ${api.url}</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 269.33px;"><img alt="" src="images/image32.png" style="width: 624.00px; height: 269.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c3"><span class="c1">We are ready to test this Grant Type!</span></p><p class="c3"><span class="c4">4. </span><span class="c1">Before testing the auth_code flow we need to point out something.</span></p><p class="c3"><span class="c1">The flow tokens is collecting the access tokens we are creating and they will be stored until we clean or invalidate them.</span></p><p class="c3"><span>The purpose of having the tokens stored is to automate as much as possible our application. But, for the purpose of showing the functionality of the </span><span class="c4">Auth Code Grant Type</span><span class="c1">&nbsp;(and the next ones), we already created a flow to invalidate the stored tokens. So that when we use this grant type we don&#39;t skip steps.</span></p><p class="c3"><span class="c1">So, first, go to Postman and send a GET request to:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/invalidate&amp;sa=D&amp;source=editors&amp;ust=1668189536024039&amp;usg=AOvVaw3GeEgF-KsjZ-sYCHKIlPfb">http://localhost:8081/invalidate</a></span><span class="c1">&nbsp; (you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3"><span class="c1">The response will be empty but what it is really doing is cleaning up the stored tokens.</span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 172.00px;"><img alt="" src="images/image109.png" style="width: 624.00px; height: 172.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span class="c1">Now, if we try to call the auth_code flow we should get this:</span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/auth_code&amp;sa=D&amp;source=editors&amp;ust=1668189536025272&amp;usg=AOvVaw1hAJ95mwh2ecH69DSR6iMV">http://localhost:8081/auth_code</a></span><span class="c5">&nbsp;</span><span class="c1">&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 314.67px;"><img alt="" src="images/image35.png" style="width: 624.00px; height: 314.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">So, we first need to authenticate.</span></p><p class="c2"><span class="c4">5.</span><span class="c1">&nbsp;For that, we go to a new tab on the browser and paste our external callback url:</span></p><p class="c2"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/login&amp;sa=D&amp;source=editors&amp;ust=1668189536026175&amp;usg=AOvVaw0L3J6wJUn8XE1HKBIYMWSj">http://localhost:8081/login</a></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span class="c1">If you receive the following error</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 81.33px;"><img alt="" src="images/image71.png" style="width: 624.00px; height: 81.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Go to Okta &rarr; My Native App &rarr; uncheck Proof Key for Code Exchange (PKCE)</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 388.00px;"><img alt="" src="images/image96.png" style="width: 624.00px; height: 388.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">Make a login request again in URL (might take some time to be in effect). It will redirect us to Okta&#39;s login page (if you aren&#39;t logged in yet) and ask for your credentials.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 484.00px;"><img alt="" src="images/image9.png" style="width: 624.00px; height: 484.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>Once logged in, a successful message will appear. In the browser URL you can see the </span><span class="c4">code</span><span>&nbsp;that is retrieving. This </span><span class="c4">code</span><span>&nbsp;is the one that is used to get the </span><span class="c4">access token</span><span class="c1">&nbsp;to call the API.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 145.33px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 145.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">Note</span><span class="c1">: If the successful message doesn&#39;t appear, just make the request to http://localhost:8081/login again.</span></p><p class="c3"><span class="c1">This access token is now stored in the Object Store Tokens. So, if we return to Postman and make a call to the auth_code flow, now we&#39;ll be able to see the response effectively.</span></p><p class="c2"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/auth_code&amp;sa=D&amp;source=editors&amp;ust=1668189536028269&amp;usg=AOvVaw1blJsRtLciNgBBlgHotmiu">http://localhost:8081/auth_code</a></span><span class="c5">&nbsp;</span><span class="c1">&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 426.67px;"><img alt="" src="images/image29.png" style="width: 624.00px; height: 426.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span>With this, we conclude the </span><span class="c4">Authorization Code Grant Type</span><span>&nbsp;part and we are ready for the next level &rarr; </span><span class="c4">Resource Owner Password Grant Type</span><span class="c1">!</span></p><p class="c3"><span class="c1">For this one, we are using the Native App also. This Grant Type and the next one (Implicit) are not predefined in the OAuth Module, so we are going to implement them manually.</span></p><p class="c3"><span class="c4">Note</span><span class="c1">: This Grant Type is also referred to as Password.</span></p><p class="c3"><span class="c4">1. </span><span class="c1">Create a new flow and name it resource_owner_password and another one named get_token. The first flow will have a flow reference to the second one that has all the logic for obtaining the token manually. And then we call the API.</span></p><p class="c3"><span class="c1">At the end, they will look like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 405.33px;"><img alt="" src="images/image36.png" style="width: 624.00px; height: 405.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">2.</span><span>&nbsp;So, let&#39;s begin. In our first flow resource_owner_password drag a </span><span class="c4">Listener</span><span class="c1">. Use the default global configuration HTTP_Listener_config and set the path to /password.</span></p><p class="c3"><span>Then, drag a </span><span class="c4">Flow Reference</span><span class="c1">&nbsp;that references the get_token flow:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 157.33px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 157.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>And finally a </span><span class="c4">Request</span><span>&nbsp;with the </span><span class="c8">default</span><span>&nbsp;configuration. As I said, in this </span><span class="c4">Request</span><span>&nbsp;operation the Password and Implicit Grant Types will not be inherited from the </span><span class="c4">OAuth</span><span>&nbsp;module. So, we are using a </span><span class="c8">default</span><span class="c1">&nbsp;configuration for both Password and Implicit:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Name: HTTP_Request_congifuration-Resource_Owner-Implicit</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 552.00px;"><img alt="" src="images/image87.png" style="width: 624.00px; height: 552.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 266.67px;"><img alt="" src="images/image52.png" style="width: 624.00px; height: 266.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">3.</span><span>&nbsp;In the next flow get_token, we start with a </span><span class="c4">Retrieve</span><span class="c1">&nbsp;operation. Maybe we already have one token in the Object Store so we are checking:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 164.00px;"><img alt="" src="images/image89.png" style="width: 624.00px; height: 164.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Also, in the advanced tab, put a target variable and value so that the payload is not overwritten.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 166.67px;"><img alt="" src="images/image42.png" style="width: 624.00px; height: 166.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">4.</span><span>&nbsp;Drag a </span><span class="c4">Logger</span><span>&nbsp;to see the </span><span class="c8">payload</span><span class="c1">.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 144.00px;"><img alt="" src="images/image28.png" style="width: 624.00px; height: 144.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">5. </span><span>Now, drag a </span><span class="c4">Choice</span><span class="c1">&nbsp;operation. If we already have a token we will log that the token is found and continue by calling the API in the upper flow. But, if we don&#39;t have a token, we will make a Request to Okta to obtain it.</span></p><p class="c3"><span>The first </span><span class="c4">When</span><span class="c1">&nbsp;element has the following expression:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c6 c5">isEmpty(vars.token)</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 174.67px;"><img alt="" src="images/image69.png" style="width: 624.00px; height: 174.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>And the second </span><span class="c4">When</span><span>&nbsp;element is the default and has a </span><span class="c4">Logger</span><span class="c1">&nbsp;printing that the token has been found.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 134.67px;"><img alt="" src="images/image60.png" style="width: 624.00px; height: 134.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">6. </span><span>Let&#39;s take a deeper look at the first </span><span class="c4">When</span><span class="c1">&nbsp;element.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">It first logs that the token wasn&#39;t found:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 129.33px;"><img alt="" src="images/image103.png" style="width: 624.00px; height: 129.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>Then, it makes the </span><span class="c4">Request</span><span>&nbsp;to </span><span class="c8">Okta</span><span class="c1">&nbsp;with the following configuration:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Name: HTTP_Request_configuration-Okta</span></p><p class="c2"><span class="c1">Host: ${okta.domain}</span></p><p class="c2"><span class="c1">Protocol: ${okta.port}</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 546.67px;"><img alt="" src="images/image94.png" style="width: 624.00px; height: 546.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 265.33px;"><img alt="" src="images/image84.png" style="width: 624.00px; height: 265.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">We set the path to:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c6 c5">${okta.token_path}</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 173.33px;"><img alt="" src="images/image73.png" style="width: 624.00px; height: 173.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span>And the we configure the </span><span class="c4">Request</span><span class="c1">&nbsp;manually:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 184.00px;"><img alt="" src="images/image81.png" style="width: 624.00px; height: 184.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">%dw 2.0</span></p><p class="c2"><span class="c1">output application/x-www-form-urlencoded</span></p><p class="c2"><span class="c1">---</span></p><p class="c2"><span class="c1">{</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; grant_type: &quot;password&quot;,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; redirect_uri: p(&#39;native_app.redirect_uri&#39;),</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; username: p(&#39;okta.username&#39;),</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; password: p(&#39;okta.password&#39;),</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; scope: p(&#39;native_app.scope&#39;), </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; client_id: p(&#39;native_app.client_id&#39;), </span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; client_secret: p(&#39;native_app.client_secret&#39;)</span></p><p class="c2"><span class="c1">}</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 254.67px;"><img alt="" src="images/image38.png" style="width: 624.00px; height: 254.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">Note</span><span class="c1">: The &lsquo;p(String)&#39; returns a string that identifies the value of one of these input properties: Mule property placeholders, System properties, or Environment variables.</span></p><p class="c3"><span>Select </span><span class="c8">Done</span><span>&nbsp;and we pass to the </span><span class="c8">Headers</span><span class="c1">&nbsp;now:</span></p><p class="c2"><span class="c1">&quot;Accept&quot;: &quot;application/json&quot;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 77.33px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 77.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>The </span><span class="c4">Request</span><span>&nbsp;configuration is finished. Now, drag a </span><span class="c4">Set Variable </span><span class="c1">to set the value of payload.access_token to the variable token:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 117.33px;"><img alt="" src="images/image77.png" style="width: 624.00px; height: 117.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>Finally, store the token by using a </span><span class="c4">Store</span><span class="c1">&nbsp;operation:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 176.00px;"><img alt="" src="images/image49.png" style="width: 624.00px; height: 176.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">When this is complete, a call will be made to the API using the access token.</span></p><p class="c3"><span class="c1">With this, we finish the entire flow for implementing the Password Grant Type. Now, we are going to test it.</span></p><p class="c3"><span class="c4">7. </span><span>Go to Postman, and make a </span><span class="c4">GET</span><span>&nbsp;Request first to /invalidate for later appreciate the difference between searching for a new token in </span><span class="c8">Okta</span><span class="c1">&nbsp;and already having a token:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/invalidate&amp;sa=D&amp;source=editors&amp;ust=1668189536039617&amp;usg=AOvVaw2LyshGLYbRn78TAm7iFl-2">http://localhost:8081/invalidate</a></span><span class="c5">&nbsp;</span><span class="c1">&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 389.33px;"><img alt="" src="images/image65.png" style="width: 624.00px; height: 389.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c6 c5"></span></p><p class="c3"><span>Now, make a </span><span class="c4">GET</span><span class="c1">&nbsp;Request to:</span></p><p class="c3"><span class="c7 c5"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/password&amp;sa=D&amp;source=editors&amp;ust=1668189536040754&amp;usg=AOvVaw3-gmFBBvkaErkNEJsLt6bz">http://localhost:8081/password</a></span><span class="c5">&nbsp; </span><span>&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3"><span class="c1">It may take a little bit to get the token because we are obtaining it from Okta now and then making a second Request to the API. But you&#39;ll see the response in 2 or 3 seconds.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 352.00px;"><img alt="" src="images/image51.png" style="width: 624.00px; height: 352.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>If we go to the </span><span class="c8">Console</span><span>&nbsp;in Studio we can see the </span><span class="c4">Logger</span><span>&nbsp;printing </span><span class="c8">&quot;Searching for new token&quot;</span><span class="c1">&nbsp;(scroll up a little bit):</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 153.33px;"><img alt="" src="images/image75.png" style="width: 624.00px; height: 153.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">If we make a Request again to /password we&#39;ll get the response almost instantly because we are using the stored token now!</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 353.33px;"><img alt="" src="images/image86.png" style="width: 624.00px; height: 353.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>And in the </span><span class="c4">Console</span><span>&nbsp;of Studio we can see the </span><span class="c4">Logger</span><span>&nbsp;printing &quot;</span><span class="c8">Token found&quot;</span><span>&nbsp;(the second </span><span class="c4">When</span><span>&nbsp;element of the </span><span class="c4">Choice</span><span class="c1">&nbsp;Router):</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 109.33px;"><img alt="" src="images/image70.png" style="width: 624.00px; height: 109.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">With this, we finish the Resource Owner Password Grant Type demonstration!</span></p><p class="c3"><span>Let&#39;s go to the </span><span class="c4">LAST ONE</span><span class="c1">&nbsp;of them, the Implicit Grant Type and finish this Codelab!</span></p><p class="c3"><span>We reached the last step! With this Grant Type we are also using the Native App in </span><span class="c8">Okta</span><span class="c1">.</span></p><p class="c3"><span>For the implementation of this one, we are going to create 4 flows and play a little bit with </span><span class="c8">DataWeave</span><span>&nbsp;and with a script of </span><span class="c8">HTML</span><span class="c1">. A big part of the complexity of this one is because it&#39;s not meant to be automated as we mentioned in the beginning.</span></p><p class="c3"><span class="c1">It&#39;s really interesting, so, let&#39;s get down to work!</span></p><p class="c3"><span class="c4">1.</span><span class="c1">&nbsp;First, let&#39;s take a look at how all this is going to work.</span></p><p class="c3"><span class="c1">Here are the 4 flows we are going to implement:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 918.67px;"><img alt="" src="images/image40.png" style="width: 624.00px; height: 918.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 570.67px;"><img alt="" src="images/image48.png" style="width: 624.00px; height: 570.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span>And, for better understanding, here is a </span><span class="c4">Sequence Diagram</span><span class="c1">&nbsp;of how all this works:</span></p><p class="c3"><span class="c4">FIRST PART</span><span class="c1">&nbsp;(obtaining the Access Token from Okta):</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 558.67px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 558.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c4">SECOND PART</span><span class="c1">&nbsp;(calling the /implicit flow from Postman to GET the API Response):</span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">2. </span><span class="c1">Before implementing everything in Studio, we need to go back to Okta to add this new callback.</span></p><p class="c3"><span>Go to the Native App general tab and select the </span><span class="c4">edit</span><span>&nbsp;button. Scroll down to </span><span class="c8">&quot;Sign-in redirect URIs&quot;</span><span class="c1">&nbsp;and add the new callback http://localhost:8081/implicit-login/callback.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 474.67px;"><img alt="" src="images/image30.png" style="width: 624.00px; height: 474.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>And </span><span class="c4">Save</span><span class="c1">&nbsp;it.</span></p><p class="c3"><span class="c4">3.</span><span class="c1">&nbsp;Alright, let&#39;s begin implementing the first flow.</span></p><p class="c3"><span>Create a new flow and name it implicit-login. This is the one that will interact with </span><span class="c8">Okta</span><span>&nbsp;and redirect us to the callback using a </span><span class="c4">302</span><span class="c1">&nbsp;status code.</span></p><p class="c3"><span class="c1">Drag a Listener, select the default HTTP_Listener_configuration and set the path to /implicit-login.</span></p><p class="c3"><span>Then, go to the responses tab. In the Headers section add vars.respHeaders and in Status code write 302. This is to perform the </span><span class="c8">redirect</span><span class="c1">.</span></p><p class="c3"><span class="c4">Note</span><span>: The variable </span><span class="c4 c8">respHeaders</span><span class="c1">&nbsp;will be then defined in the transform message at the end of this flow.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 220.00px;"><img alt="" src="images/image95.png" style="width: 624.00px; height: 220.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Drag a </span><span class="c4">Logger</span><span class="c1">&nbsp;just to keep track of which flow is executing:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 140.00px;"><img alt="" src="images/image68.png" style="width: 624.00px; height: 140.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>And at the end, add a </span><span class="c4">Transform</span><span>. Select the output to be the </span><span class="c8">variable </span><span>respHeaders and write the next </span><span class="c8">DataWeave</span><span class="c1">&nbsp;code to perform the redirect:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">%dw 2.0</span></p><p class="c2"><span class="c1">output application/java</span></p><p class="c2"><span class="c1">var queryParams = {</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; client_id: p(&quot;native_app.client_id&quot;),,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; response_type: &quot;token&quot;,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; scope: &quot;openid&quot;,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; redirect_uri: &quot;http://localhost:8081/implicit-login/callback&quot;,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; state: &quot;state-296bc9a0-a2a2-4a57-be1a-d0e2fd9bb601&quot;,</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; nonce: &quot;foo&quot;</span></p><p class="c2"><span class="c1">}</span></p><p class="c2"><span class="c1">---</span></p><p class="c2"><span class="c1">{</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &quot;Location&quot; : p(&quot;okta.auth_url&quot;)++&quot;?&quot; ++</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((queryParams pluck ($$ ++ &quot;=&quot; ++ $)) joinBy &quot;&amp;&quot;)</span></p><p class="c2"><span class="c1">}</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 177.33px;"><img alt="" src="images/image101.png" style="width: 624.00px; height: 177.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c4">4. </span><span class="c1">The next flow to implement is the callback.</span></p><p class="c3"><span>Create a new flow and name it implicit-login-callback. This one loads an </span><span class="c4">HTML</span><span class="c1">&nbsp;script that is executed in the browser.</span></p><p class="c3"><span>What is does is remove from the URL the </span><span class="c4">hash</span><span class="c1">&nbsp;(#) before the access token present in the URL. If the hash was there, we wouldn&#39;t be able to obtain the token from the URL. So, we need to do this &quot;trick&quot;.</span></p><p class="c3"><span>First of all, drag a </span><span class="c4">Listener</span><span class="c1">, select the default HTTP_Listener_configuration and set the path to /implicit-login/callback.</span></p><p class="c3"><span class="c1">Now we are going to write the script.</span></p><p class="c3"><span>From the </span><span class="c4">Package Explorer</span><span class="c1">, go to src/main/resources and create a new file:</span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 690.67px;"><img alt="" src="images/image104.png" style="width: 624.00px; height: 690.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c1">Name it get_url.html.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>It will open a new tab in your browser but just go back to Studio. Right click on the file and select &quot;</span><span class="c8">Open With &rarr; Other... &quot;</span><span class="c1">:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 192.00px;"><img alt="" src="images/image21.png" style="width: 624.00px; height: 192.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>Select &quot;</span><span class="c8">Internal editors&quot;</span><span>, &quot;</span><span class="c8">Text Editor&quot;</span><span>&nbsp;and &quot;</span><span class="c8">Use it for all &lsquo;*html&#39; files&quot;</span><span class="c1">:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 733.33px;"><img alt="" src="images/image79.png" style="width: 624.00px; height: 733.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">Now, paste this script:</span></p><p class="c13"><span class="c19 c10">Copy</span></p><p class="c2"><span class="c6 c5">&lt;!DOCTYPE html&gt;</span></p><p class="c2"><span class="c6 c5">&lt;html&gt;</span></p><p class="c2"><span class="c6 c5">&lt;body&gt;</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span class="c6 c5">&lt;p id=&quot;any&quot;&gt;&lt;/p&gt;</span></p><p class="c2"><span class="c6 c5">&lt;p id=&quot;status&quot;&gt;&lt;/p&gt;</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span class="c6 c5">&lt;script&gt;</span></p><p class="c2"><span class="c6 c5">&nbsp; window.onload = function() {</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; const Http = new XMLHttpRequest();</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; const url=&#39;http://localhost:8081/implicit/save-token?url=&#39; + encodeURIComponent(window.location.href);</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; Http.open(&quot;GET&quot;, url);</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; Http.onreadystatechange = (e) =&gt; {</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; console.log(Http.responseText);</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; document.getElementById(&quot;any&quot;).innerHTML = &quot;Successful call&quot;;</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; }</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; Http.send();</span></p><p class="c2"><span class="c6 c5">&nbsp; };</span></p><p class="c2"><span class="c6 c5">&lt;/script&gt; </span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span class="c6 c5">&lt;script&gt;</span></p><p class="c2"><span class="c6 c5">document.getElementById(&quot;any&quot;).innerHTML = </span></p><p class="c2"><span class="c6 c5">window.location.href;</span></p><p class="c2"><span class="c6 c5">&lt;/script&gt;</span></p><p class="c0"><span class="c6 c5"></span></p><p class="c2"><span class="c6 c5">&lt;/body&gt;</span></p><p class="c2"><span class="c6 c5">&lt;/html&gt;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">This script is calling the last flow implicit-save-token and saving the entire URL in a Query Parameter named url. Then we will access that url and get the access token.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Once the script is ready, go back to the implicit-login-callback flow and drag a Load static resource operation. Configure as this:</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c6 c5">Resource base path: ${static_resource.path}</span></p><p class="c2"><span class="c6 c5">Default file: get_url.html</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 142.67px;"><img alt="" src="images/image20.png" style="width: 624.00px; height: 142.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">Now is time to go back to the config.yaml and set the path where the script is.</span></p><p class="c3"><span class="c1">In my case is like this:</span></p><p class="c3"><span class="c1">&quot;/Users/aemiliani/Documents/Andres/Workspaces/Security Training/oauth_test/src/main/resources&quot;</span></p><p class="c3"><span class="c1">In your case it will be different. If you want to find the path/location of the file easily, you can right click in the folder src/main/resources and select Properties.</span></p><p class="c3"><span class="c1">From there, copy the entire path (the one next to Location) and then close this window:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 380.00px;"><img alt="" src="images/image63.png" style="width: 624.00px; height: 380.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Now paste it in the config.yaml</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 42.67px;"><img alt="" src="images/image61.png" style="width: 624.00px; height: 42.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span>Go back to the implicit-login-callback flow and add a </span><span class="c4">Logger</span><span>&nbsp;to log the </span><span class="c8">payload</span><span class="c1">.</span></p><p class="c3"><span class="c4">5.</span><span class="c1">&nbsp;That was all for the callback, now, we are going to implement the flow to save the token for later using it in the implicit flow to call the API.</span></p><p class="c3"><span class="c1">Create a new flow and call it implicit-save-token. This flow will get the access token in the URL that the implicit-login-callback flow obtained and it will save it in the Object Store Tokens that we created.</span></p><p class="c3"><span>Drag a </span><span class="c4">Listener</span><span class="c1">, select the default HTTP_Listener_configuration and set the path to /implicit/save-token.</span></p><p class="c3"><span>Drag a </span><span class="c4">Logger</span><span class="c1">&nbsp;to control that the URL we are getting is OK.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 126.67px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 126.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>Then, add a </span><span class="c4">Transform</span><span>&nbsp;component. Select the </span><span class="c8">Output payload</span><span class="c1">&nbsp;and paste this DataWeave code:</span></p><p class="c2"><span class="c6 c5">%dw 2.0</span></p><p class="c2"><span class="c6 c5">import * from dw::core::URL</span></p><p class="c2"><span class="c6 c5">output application/java</span></p><p class="c2"><span class="c6 c5">---</span></p><p class="c2"><span class="c6 c5">{(splitBy(parseURI(attributes.queryParams.url).fragment, &quot;&amp;&quot;) map (</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; do {</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; &nbsp; var param = $ splitBy &nbsp;&quot;=&quot;</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; &nbsp; ---</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (param[0]): param[1]</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c2"><span class="c6 c5">&nbsp; &nbsp; }</span></p><p class="c2"><span class="c6 c5">))}.access_token</span></p><p class="c0"><span class="c1"></span></p><hr style="page-break-before:always;display:none;"><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 209.33px;"><img alt="" src="images/image8.png" style="width: 624.00px; height: 209.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">This code is getting only the access token from the URL we got and passing it to the next processors as the payload.</span></p><p class="c3"><span class="c4">Note</span><span>: Don&#39;t pay attention to the </span><span class="c8">&quot;issue&quot;</span><span class="c1">, it is nothing relevant, you can Run the program without inconvenients.</span></p><p class="c3"><span>Drag a </span><span class="c4">Logger</span><span class="c1">&nbsp;to log the payload, that should be only the access token.</span></p><p class="c3"><span>Finally, add a </span><span class="c4">Store</span><span>&nbsp;operation from the </span><span class="c8">OAuth module</span><span class="c1">&nbsp;to store the access token obtained.</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 186.67px;"><img alt="" src="images/image62.png" style="width: 624.00px; height: 186.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">This is all for the flow to save the token!</span></p><p class="c3"><span class="c4">6. </span><span class="c1">Finally, the last one...</span></p><p class="c3"><span class="c1">Create a new flow and name it implicit. This one just gets the access token and calls the Random User API.</span></p><p class="c3"><span>Drag a </span><span class="c4">Listener</span><span class="c1">, select the default HTTP_Listener_configuration and set the path to /implicit.</span></p><p class="c3"><span>Drag a </span><span class="c4">Retrieve</span><span>&nbsp;operation from the </span><span class="c8">OAuth</span><span class="c1">&nbsp;module and configure like this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 154.67px;"><img alt="" src="images/image25.png" style="width: 624.00px; height: 154.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">Here we are obtaining the token for then calling the Random User API.</span></p><p class="c3"><span class="c1">In the advanced tab, add a target variable and value:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 106.67px;"><img alt="" src="images/image55.png" style="width: 624.00px; height: 106.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span>Finally, call the API. Drag a </span><span class="c4">Request</span><span>&nbsp;and select the HTTP_Request_configuration-Resource_Owner-Implicit (the same we used for </span><span class="c4">Resource Owner Password</span><span class="c1">&nbsp;Grant Type) and add the in the URL ${api.url}.</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 218.67px;"><img alt="" src="images/image110.png" style="width: 624.00px; height: 218.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1"></span></p><p class="c3"><span class="c1">We are all set! Now let&#39;s try it out!</span></p><p class="c3"><span class="c4">6.</span><span class="c1">&nbsp;Same as in Auth Code flow. First make a GET request to:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/invalidate&amp;sa=D&amp;source=editors&amp;ust=1668189536057979&amp;usg=AOvVaw0EWULUYAG7ck5opoaeDva-">http://localhost:8081/invalidate</a></span><span class="c1">&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3"><span class="c1">The response will be empty but it is cleaning up the stored tokens.</span></p><p class="c3"><span class="c1">Then, if we try to call the implicit flow we should get this:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/implicit&amp;sa=D&amp;source=editors&amp;ust=1668189536058432&amp;usg=AOvVaw3CpPrgARQuJ1UvlqrzM1xR">http://localhost:8081/implicit</a></span><span class="c1">&nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 302.67px;"><img alt="" src="images/image53.png" style="width: 624.00px; height: 302.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span class="c1">We first need to authenticate.</span></p><p class="c3"><span class="c1">Open a new tab in your browser and call the implicit-login flow:</span></p><p class="c3"><span class="c1">http://localhost:8081/implicit-login</span></p><p class="c3"><span class="c1">It will redirect us to Okta&#39;s login page (if you aren&#39;t logged in yet) and ask for your credentials.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 365.33px;"><img alt="" src="images/image27.png" style="width: 624.00px; height: 365.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span>Once logged in, a successful message (</span><span class="c8">&quot;successfully retrieved access token&quot;</span><span>&nbsp;or </span><span class="c8">&quot;successful call&quot;</span><span>, something like that) will appear. In the browser URL you will be able to see the unaccessible access token with the hash</span><span class="c4">&nbsp;# </span><span class="c1">before.</span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 110.67px;"><img alt="" src="images/image105.png" style="width: 624.00px; height: 110.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c12"><span class="c1"></span></p><p class="c3"><span class="c4">Note</span><span class="c1">: If the successful message doesn&#39;t appear, just make the request to http://localhost:8081/implicit-login again.</span></p><p class="c3"><span class="c1">The &lsquo;magic&#39; will be done and the access token is now stored in the Object Store Tokens.</span></p><p class="c3"><span class="c1">Return to Postman and make a GET request again to:</span></p><p class="c3"><span class="c7"><a class="c14" href="https://www.google.com/url?q=http://localhost:8081/implicit&amp;sa=D&amp;source=editors&amp;ust=1668189536060177&amp;usg=AOvVaw1isx2o4KUplyP_Im0yJyLP">http://localhost:8081/implicit</a></span><span>&nbsp; &nbsp;(you can find this endpoint in postman api file in src/test/resources of the github project)</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 396.00px;"><img alt="" src="images/image66.png" style="width: 624.00px; height: 396.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">And there is the response! This is great, we&#39;ve got to the end of this tutorial. But, there is one more thing... just jump to the next step!</span></p><p class="c3"><span>If you want to learn more about </span><span class="c4">Okta</span><span>, </span><span class="c4">OAuth 2.0</span><span>, </span><span class="c4">Anypoint Platform</span><span>, </span><span class="c4">Anypoint Studio</span><span>&nbsp;and how to set up </span><span class="c4">Client Management</span><span class="c1">, here is a Codelab I wrote for you:</span></p><p class="c2"><span class="c7"><a class="c14" href="https://www.google.com/url?q=https://conflowence.atlassian.net/l/cp/pxMyh8wW&amp;sa=D&amp;source=editors&amp;ust=1668189536061274&amp;usg=AOvVaw2dc3C6hu_lvheGn-61BjKs">https://conflowence.atlassian.net/l/cp/pxMyh8wW</a></span><span class="c1">&nbsp;</span></p><p class="c0"><span class="c1"></span></p><p class="c2"><span class="c1">Thank you for reading! I hope you could make it to the end and I hope you enjoyed the Codelab!</span></p><p class="c0"><span class="c1"></span></p><p class="c24"><span class="c1">&#x1f60e;&#x1f60e;&#x1f60e;</span></p><p class="c0"><span class="c1"></span></p><p class="c24"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 301.50px; height: 149.00px;"><img alt="" src="images/image24.png" style="width: 301.50px; height: 149.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><div><p class="c0"><span class="c1"></span></p></div></body></html>